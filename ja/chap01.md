<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax:{inlineMath:[['\$','\$'],['\\(','\\)']],processEscapes:true},CommonHTML: {matchFontHeight:false}});</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

# 第1章 評価履歴

## 準備
次のコードを書きなさい。

```python
import numpy as np
```

## 評価履歴
次の行列$$D_{u}$$はユーザ$$u$$の評価履歴である。$$D_{u}$$の$$i$$行目はアイテム$$i \in I$$に関するデータを表す。$$D_{u}$$の$$i$$行目の1列目と2列目はアイテム$$i$$の特徴ベクトル$$\boldsymbol{x}_{i}$$に対応し、3列目はユーザ$$u$$のアイテム$$i$$に対する評価値$$r_{u,i}$$に対応する。$$r_{u,i}=+1$$は「好き」を、$$r_{u,i}=-1$$は「嫌い」を表す。ただし、$$?$$はユーザ$$u$$が未評価、すなわち欠損値であることを示す。

$$
D_{u} = \left[
 \begin{array}{rrr}
  5 & 3 & +1 \\
  6 & 2 & +1 \\
  4 & 1 & +1 \\
  8 & 5 & -1 \\
  2 & 4 & -1 \\
  3 & 6 & -1 \\
  7 & 6 & -1 \\
  4 & 2 &  ? \\
  5 & 1 &  ? \\
  8 & 6 &  ? \\
  3 & 4 &  ? \\
  4 & 7 &  ? \\
  4 & 4 &  ? \\
 \end{array}
\right]
$$

このとき、次の問いに答えなさい。

### 01 評価履歴の生成
$$D_{u}$$を`ndarray`の行列として生成するコードを書きなさい。得られた`ndarray`を`Du`とすること。

★
1. `numpy.nan`を使う。
2. `numpy.array()`を使う。

### 02 評価履歴の表示
`Du`の内容を表示するコードを書きなさい。

結果
```bash
Du = 
[[ 5.  3.  1.]
 [ 6.  2.  1.]
 [ 4.  1.  1.]
 [ 8.  5. -1.]
 [ 2.  4. -1.]
 [ 3.  6. -1.]
 [ 7.  6. -1.]
 [ 4.  2. nan]
 [ 5.  1. nan]
 [ 8.  6. nan]
 [ 3.  4. nan]
 [ 4.  7. nan]
 [ 4.  4. nan]]
 ```

★
1. `print()`を使う。

★★
1. `print()`を使う。
2. `str.format()`を使う。

### 03 評価履歴の形状
`Du`の形状を取得し、表示するコードを書きなさい。

結果
```bash
Duの形状 = (13, 3)
```

★
1. `ndarray.shape`を使う。
2. `print()`を使う。

### 04 評価履歴の行数
`Du`の行数を取得し、表示するコードを書きなさい。

結果
```bash
Duの行数 = 13
```

★
1. `ndarray.shape`を使う。
2. `print()`を使う。

### 05 評価履歴の列数
`Du`の列数を取得し、表示するコードを書きなさい。

結果
```bash
Duの列数 = 3
```

★
1. `ndarray.shape`を使う。
2. `print()`を使う。

### 06 評価履歴の全要素数
`Du`の全要素数を取得し、表示するコードを書きなさい。ただし、欠損値も含む。

結果
```bash
Duの全要素数 = 39
```

★
1. `ndarray.size`を使う。
2. `print()`を使う。

### 07 アイテム集合
`Du`の各行のインデックスは各アイテム$$i \in I$$のアイテムIDに対応する。アイテム集合$$I$$を、アイテムIDを要素とした`ndarray`のベクトル`I`として生成しなさい。

★★
1. `np.arange()`を使う。
2. `ndarray.shape`を使う。

### 08 評価履歴からアイテムの特徴ベクトルの集合の取得 | 行列のスライス
`Du`からアイテムの特徴ベクトルの集合（各アイテムの特徴ベクトルを縦に結合した行列）を`ndarray`の行列`x`として取得しなさい。

★★
1. 行列のスライスを使う。

### 09 特徴ベクトルの取得 | 行列のインデックス参照
`x`からアイテム0の特徴ベクトル$$\boldsymbol{x}_{0}$$を取得しなさい。

★
1. 行列のインデックス参照を使う。

### 10 評価履歴から評価値集合の取得 | 行列のスライス
`Du`から評価値集合（各評価値を要素としたベクトル）を`ndarray`のベクトル`ru`として取得しなさい。

★★
1. 行列のスライスを使う。

### 11 評価値集合の形状の取得 | ベクトルの形状
`ru`の形状を取得しなさい。

★
1. `ndarray.shape`を使う。

### 12 評価値集合の要素数の取得 | ベクトルの要素数
`ru`の要素数を取得しなさい。

★
1. `ndarray.size`を使う。

### 13 評価値集合から部分集合の取得 | ベクトルのスライス
`ru`の2番目から4番目の評価値を取得しなさい。

★
1. ベクトルのスライスを使う。

### 14 評価値集合の要素を逆順に取得 | ベクトルのスライス（逆順）
`ru`の要素を逆順に取得しなさい。

★★
1. ベクトルのスライスを使う。

### 15 評価値の取得 | ベクトルのインデックス参照
`ru`からアイテム0に対する評価値$$r_{u,0}$$を取得しなさい。

★
1. ベクトルのインデックス参照を使う。

### 16 対象ユーザが未評価であるか否かの判定 | 条件判定によるブール値配列
`ru`において、欠損値の要素には`True`を、それ以外の要素には`False`を入れたブール値配列を取得しなさい。

★
1. `numpy.isnan()`を使う。

### 17 対象ユーザが評価済みであるか否かの判定 | 条件判定によるブール値配列
`ru`において、欠損値の要素には`False`を、それ以外の要素には`True`を入れたブール値配列を取得しなさい。

★
1. `numpy.isnan()`を使う。
2. `~`演算子を使う。

### 18 対象ユーザが評価済みのアイテム集合 | ベクトルのブールインデックス参照
`I`から対象ユーザ$$u$$が評価済みのアイテム集合$$I_{u}$$を`ndarray`のベクトル`Iu`として取得しなさい。

★★
1. ベクトルのブールインデックス参照を使う。

### 19 対象ユーザが「好き」と評価したアイテム集合 | ベクトルのブールインデックス参照
`I`から対象ユーザ$$u$$が「好き」と評価したアイテム集合$$I_{u}^{+}$$（$$r_{u,i}=+1$$を満たすアイテム集合）を`ndarray`のベクトル`Iup`として取得しなさい。

★★
1. ベクトルのブールインデックス参照を使う。

### 20 対象ユーザが「嫌い」と評価したアイテム集合 | ベクトルのブールインデックス参照
`I`から対象ユーザ$$u$$が「嫌い」と評価したアイテム集合$$I_{u}^{-}$$（$$r_{u,i}=-1$$を満たすアイテム集合）を`ndarray`のベクトル`Iun`として取得しなさい。

★★
1. ベクトルのブールインデックス参照を使う。


【ToDo】
訓練データと予測対象データ、評価値+1,-1の事例についても追加


