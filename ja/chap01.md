<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax:{inlineMath:[['\$','\$'],['\\(','\\)']],processEscapes:true},CommonHTML: {matchFontHeight:false}});</script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

# 第1章 評価履歴と評価値行列

## 準備
次のコードを入力しなさい。

```python
import numpy as np
```

## 評価履歴
次の行列$$D_{u}$$は対象ユーザ$$u$$の評価履歴である。$$D_{u}$$の$$i$$行目はアイテム$$i \in I$$に関するデータを表す。$$D_{u}$$の1列目と2列目はアイテム$$i$$の特徴ベクトル$$\boldsymbol{x}_{i}$$に対応し、3列目はユーザ$$u$$のアイテム$$i$$に対する評価値$$r_{u,i}$$に対応する。$$r_{u,i}=+1$$は「好き」を、$$r_{u,i}=-1$$は「嫌い」を表す。ただし、$$?$$はユーザ$$u$$が未評価、すなわち欠損値であることを示す。

$$
D_{u} = \left[
 \begin{array}{rrr}
  5 & 3 & +1 \\
  6 & 2 & +1 \\
  4 & 1 & +1 \\
  8 & 5 & -1 \\
  2 & 4 & -1 \\
  3 & 6 & -1 \\
  7 & 6 & -1 \\
  4 & 2 &  ? \\
  5 & 1 &  ? \\
  8 & 6 &  ? \\
  3 & 4 &  ? \\
  4 & 7 &  ? \\
  4 & 4 &  ? \\
 \end{array}
\right]
$$

### 01 評価履歴の生成 | 行列の生成
$$D_{u}$$を`ndarray`の行列`Du`として生成しなさい。

★
1. `numpy.array()`を使う。
2. `numpy.nan`を使う。

### 02 評価履歴の表示 | 行列の内容の表示
`Du`の内容を表示しなさい。

★
1. `print()`を使う。

★★
1. `print()`を使う。
2. `str.format()`を使う。

### 03 評価履歴の形状の取得 | 行列の形状
`Du`の形状を取得しなさい。

★
1. `ndarray.shape`を使う。

### 04 評価履歴の行数の取得 | 行列の行数
`Du`の行数を取得しなさい。

★
1. `ndarray.shape`を使う。


### 05 評価履歴の列数の取得 | 行列の列数
`Du`の列数を取得しなさい。

★
1. `ndarray.shape`を使う。

### 06 評価履歴の全要素数の取得 | 行列の全要素数
`Du`の全要素数を取得しなさい。ただし、欠損値も含む。

★
1. `ndarray.size`を使う。

### 07 評価履歴からアイテム集合の取得 | ベクトルの生成
`Du`の各行のインデックスはそれぞれのアイテムIDに対応する。アイテム集合$$I$$を、アイテムIDを要素とした`ndarray`のベクトル`I`として生成しなさい。

★★
1. `np.arange()`を使う。
2. `ndarray.shape`を使う。

### 08 評価履歴からアイテムの特徴ベクトルの集合の取得 | 行列のスライス
`Du`からアイテムの特徴ベクトルの集合（各アイテムの特徴ベクトルを縦に結合した行列）を`ndarray`の行列`x`として取得しなさい。

★★
1. 行列のスライスを使う。

### 09 アイテム$$i$$の特徴ベクトルの取得 | 行列のインデックス参照
`x`からアイテム0の特徴ベクトル$$\boldsymbol{x}_{0}$$を取得しなさい。

★
1. 行列のインデックス参照を使う。

### 10 評価履歴から評価値集合の取得 | 行列のスライス
`Du`から評価値集合（各評価値を要素としたベクトル）を`ndarray`のベクトル`ru`として取得しなさい。

★★
1. 行列のスライスを使う。

### 11 評価値集合の形状の取得 | ベクトルの形状
`ru`の形状を取得しなさい。

★
1. `ndarray.shape`を使う。

### 12 評価値集合の要素数の取得 | ベクトルの要素数
`ru`の要素数を取得しなさい。

★
1. `ndarray.size`を使う。

### 13 評価値集合から部分集合の取得 | ベクトルのスライス
`ru`の2番目から4番目の評価値を取得しなさい。

★
1. ベクトルのスライスを使う。

### 14 評価値集合の要素を逆順に取得 | ベクトルのスライス（逆順）
`ru`の要素を逆順に取得しなさい。

★★
1. ベクトルのスライスを使う。

### 15 アイテム$$i$$に対する評価値の取得 | ベクトルのインデックス参照
`ru`からアイテム0に対する評価値$$r_{u,0}$$を取得しなさい。

★
1. ベクトルのインデックス参照を使う。

### 16 対象ユーザ$$u$$が未評価であるか否かの判定 | 条件判定によるブール値配列
`ru`において、欠損値の要素には`True`を、それ以外の要素には`False`を入れたブール値配列を取得しなさい。

★
1. `numpy.isnan()`を使う。

### 17 対象ユーザ$$u$$が評価済みであるか否かの判定 | 条件判定によるブール値配列
`ru`において、欠損値の要素には`False`を、それ以外の要素には`True`を入れたブール値配列を取得しなさい。

★
1. `numpy.isnan()`を使う。
2. `~`演算子を使う。

### 18 対象ユーザ$$u$$が評価済みのアイテム集合 | ベクトルのブールインデックス参照
`I`から対象ユーザ$$u$$が評価済みのアイテム集合$$I_{u}$$を`ndarray`のベクトル`Iu`として取得しなさい。

★★
1. ベクトルのブールインデックス参照を使う。

### 19 対象ユーザ$$u$$が「好き」と評価したアイテム集合 | ベクトルのブールインデックス参照
`I`から対象ユーザ$$u$$が「好き」と評価したアイテム集合$$I_{u}^{+}$$（$$r_{u,i}=+1$$を満たすアイテム集合）を取得しなさい。取得したベクトルを`Iup`とすること。

★★
1. ベクトルのブールインデックス参照を使う。

### 20 対象ユーザ$$u$$が「嫌い」と評価したアイテム集合 | ベクトルのブールインデックス参照
`I`から対象ユーザ$$u$$が「嫌い」と評価したアイテム集合$$I_{u}^{-}$$（$$r_{u,i}=-1$$を満たすアイテム集合）を取得しなさい。取得したベクトルを`Iun`とすること。

★★
1. ベクトルのブールインデックス参照を使う。

## 評価値行列

### 22 評価値行列の生成 | 行列の生成
次の行列$\boldsymbol{R}$を`ndarray`として生成しなさい。ただし、`?`は欠損値として入力すること。生成した行列を`を`R`とすること。

$$
\boldsymbol{R} = \left[
 \begin{array}{rrrrrr}
  ? & 4 & 3 & 1 & 2 & ? \\
  5 & 5 & 4 & ? & 3 & 3 \\
  4 & ? & 5 & 3 & 2 & ? \\
  ? & 3 & ? & 2 & 1 & 1 \\
  2 & 1 & 2 & 4 & ? & 3 \\
 \end{array}
\right]
$$

★
1. `numpy.array()`を使う。

### 23 評価値行列からユーザ集合の取得 | ベクトルの生成
`R`の各行のインデックスはそれぞれのユーザIDに対応する。`R`からユーザ集合（ユーザIDを要素としたベクトル）を`ndarray`として生成しなさい。生成したベクトルを`U`とすること。

★
1. `numpy.arange()`を使う。
2. `ndarray.shape`を使う。

### 24 評価値行列からアイテム集合の取得 | ベクトルの生成
`R`の各列のインデックスはそれぞれのアイテムIDに対応する。`R`からアイテム集合（アイテムIDを要素としたベクトル）を`ndarray`として生成しなさい。生成したベクトルを`I`とすること。

★
1. `numpy.arange()`を使う。
2. `ndarray.shape`を使う。

### 25 ユーザ数の取得 | ベクトルの要素数の取得
`U`の要素数を取得しなさい。

★
1. `ndarray.size`を使う。

### 26 アイテム数の取得 | ベクトルの要素数の取得
`I`の要素数を取得しなさい。

★
1. `ndarray.size`を使う。

### 27 評価値の取得 | ベクトルのインデックス参照
`R`の`(u, i)`成分はユーザ`u`のアイテム`i`に対する評価値を表す。`R`からユーザ`0`のアイテム`1`に対する評価値を取得しなさい。

★
1. ベクトルのインデックス参照を使う。
